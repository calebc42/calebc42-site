<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
<head>
<!-- 2025-09-13 Sat 13:37 -->
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Building and Securing a Host OS</title>
<meta name="author" content="Caleb Christensen" />
<meta name="description" content="My experience going from a blank slate to a secure, encrypted, remotely-accessible Debian host, ready for virtualization." />
<meta name="generator" content="Org Mode" />
<style type="text/css">
  #content { max-width: 60em; margin: auto; }
  .title  { text-align: center;
             margin-bottom: .2em; }
  .subtitle { text-align: center;
              font-size: medium;
              font-weight: bold;
              margin-top:0; }
  .todo   { font-family: monospace; color: red; }
  .done   { font-family: monospace; color: green; }
  .priority { font-family: monospace; color: orange; }
  .tag    { background-color: #eee; font-family: monospace;
            padding: 2px; font-size: 80%; font-weight: normal; }
  .timestamp { color: #bebebe; }
  .timestamp-kwd { color: #5f9ea0; }
  .org-right  { margin-left: auto; margin-right: 0px;  text-align: right; }
  .org-left   { margin-left: 0px;  margin-right: auto; text-align: left; }
  .org-center { margin-left: auto; margin-right: auto; text-align: center; }
  .underline { text-decoration: underline; }
  #postamble p, #preamble p { font-size: 90%; margin: .2em; }
  p.verse { margin-left: 3%; }
  pre {
    border: 1px solid #e6e6e6;
    border-radius: 3px;
    background-color: #f2f2f2;
    padding: 8pt;
    font-family: monospace;
    overflow: auto;
    margin: 1.2em;
  }
  pre.src {
    position: relative;
    overflow: auto;
  }
  pre.src:before {
    display: none;
    position: absolute;
    top: -8px;
    right: 12px;
    padding: 3px;
    color: #555;
    background-color: #f2f2f299;
  }
  pre.src:hover:before { display: inline; margin-top: 14px;}
  /* Languages per Org manual */
  pre.src-asymptote:before { content: 'Asymptote'; }
  pre.src-awk:before { content: 'Awk'; }
  pre.src-authinfo::before { content: 'Authinfo'; }
  pre.src-C:before { content: 'C'; }
  /* pre.src-C++ doesn't work in CSS */
  pre.src-clojure:before { content: 'Clojure'; }
  pre.src-css:before { content: 'CSS'; }
  pre.src-D:before { content: 'D'; }
  pre.src-ditaa:before { content: 'ditaa'; }
  pre.src-dot:before { content: 'Graphviz'; }
  pre.src-calc:before { content: 'Emacs Calc'; }
  pre.src-emacs-lisp:before { content: 'Emacs Lisp'; }
  pre.src-fortran:before { content: 'Fortran'; }
  pre.src-gnuplot:before { content: 'gnuplot'; }
  pre.src-haskell:before { content: 'Haskell'; }
  pre.src-hledger:before { content: 'hledger'; }
  pre.src-java:before { content: 'Java'; }
  pre.src-js:before { content: 'Javascript'; }
  pre.src-latex:before { content: 'LaTeX'; }
  pre.src-ledger:before { content: 'Ledger'; }
  pre.src-lisp:before { content: 'Lisp'; }
  pre.src-lilypond:before { content: 'Lilypond'; }
  pre.src-lua:before { content: 'Lua'; }
  pre.src-matlab:before { content: 'MATLAB'; }
  pre.src-mscgen:before { content: 'Mscgen'; }
  pre.src-ocaml:before { content: 'Objective Caml'; }
  pre.src-octave:before { content: 'Octave'; }
  pre.src-org:before { content: 'Org mode'; }
  pre.src-oz:before { content: 'OZ'; }
  pre.src-plantuml:before { content: 'Plantuml'; }
  pre.src-processing:before { content: 'Processing.js'; }
  pre.src-python:before { content: 'Python'; }
  pre.src-R:before { content: 'R'; }
  pre.src-ruby:before { content: 'Ruby'; }
  pre.src-sass:before { content: 'Sass'; }
  pre.src-scheme:before { content: 'Scheme'; }
  pre.src-screen:before { content: 'Gnu Screen'; }
  pre.src-sed:before { content: 'Sed'; }
  pre.src-sh:before { content: 'shell'; }
  pre.src-sql:before { content: 'SQL'; }
  pre.src-sqlite:before { content: 'SQLite'; }
  /* additional languages in org.el's org-babel-load-languages alist */
  pre.src-forth:before { content: 'Forth'; }
  pre.src-io:before { content: 'IO'; }
  pre.src-J:before { content: 'J'; }
  pre.src-makefile:before { content: 'Makefile'; }
  pre.src-maxima:before { content: 'Maxima'; }
  pre.src-perl:before { content: 'Perl'; }
  pre.src-picolisp:before { content: 'Pico Lisp'; }
  pre.src-scala:before { content: 'Scala'; }
  pre.src-shell:before { content: 'Shell Script'; }
  pre.src-ebnf2ps:before { content: 'ebfn2ps'; }
  /* additional language identifiers per "defun org-babel-execute"
       in ob-*.el */
  pre.src-cpp:before  { content: 'C++'; }
  pre.src-abc:before  { content: 'ABC'; }
  pre.src-coq:before  { content: 'Coq'; }
  pre.src-groovy:before  { content: 'Groovy'; }
  /* additional language identifiers from org-babel-shell-names in
     ob-shell.el: ob-shell is the only babel language using a lambda to put
     the execution function name together. */
  pre.src-bash:before  { content: 'bash'; }
  pre.src-csh:before  { content: 'csh'; }
  pre.src-ash:before  { content: 'ash'; }
  pre.src-dash:before  { content: 'dash'; }
  pre.src-ksh:before  { content: 'ksh'; }
  pre.src-mksh:before  { content: 'mksh'; }
  pre.src-posh:before  { content: 'posh'; }
  /* Additional Emacs modes also supported by the LaTeX listings package */
  pre.src-ada:before { content: 'Ada'; }
  pre.src-asm:before { content: 'Assembler'; }
  pre.src-caml:before { content: 'Caml'; }
  pre.src-delphi:before { content: 'Delphi'; }
  pre.src-html:before { content: 'HTML'; }
  pre.src-idl:before { content: 'IDL'; }
  pre.src-mercury:before { content: 'Mercury'; }
  pre.src-metapost:before { content: 'MetaPost'; }
  pre.src-modula-2:before { content: 'Modula-2'; }
  pre.src-pascal:before { content: 'Pascal'; }
  pre.src-ps:before { content: 'PostScript'; }
  pre.src-prolog:before { content: 'Prolog'; }
  pre.src-simula:before { content: 'Simula'; }
  pre.src-tcl:before { content: 'tcl'; }
  pre.src-tex:before { content: 'TeX'; }
  pre.src-plain-tex:before { content: 'Plain TeX'; }
  pre.src-verilog:before { content: 'Verilog'; }
  pre.src-vhdl:before { content: 'VHDL'; }
  pre.src-xml:before { content: 'XML'; }
  pre.src-nxml:before { content: 'XML'; }
  /* add a generic configuration mode; LaTeX export needs an additional
     (add-to-list 'org-latex-listings-langs '(conf " ")) in .emacs */
  pre.src-conf:before { content: 'Configuration File'; }

  table { border-collapse:collapse; }
  caption.t-above { caption-side: top; }
  caption.t-bottom { caption-side: bottom; }
  td, th { vertical-align:top;  }
  th.org-right  { text-align: center;  }
  th.org-left   { text-align: center;   }
  th.org-center { text-align: center; }
  td.org-right  { text-align: right;  }
  td.org-left   { text-align: left;   }
  td.org-center { text-align: center; }
  dt { font-weight: bold; }
  .footpara { display: inline; }
  .footdef  { margin-bottom: 1em; }
  .figure { padding: 1em; }
  .figure p { text-align: center; }
  .equation-container {
    display: table;
    text-align: center;
    width: 100%;
  }
  .equation {
    vertical-align: middle;
  }
  .equation-label {
    display: table-cell;
    text-align: right;
    vertical-align: middle;
  }
  .inlinetask {
    padding: 10px;
    border: 2px solid gray;
    margin: 10px;
    background: #ffffcc;
  }
  #org-div-home-and-up
   { text-align: right; font-size: 70%; white-space: nowrap; }
  textarea { overflow-x: auto; }
  .linenr { font-size: smaller }
  .code-highlighted { background-color: #ffff00; }
  .org-info-js_info-navigation { border-style: none; }
  #org-info-js_console-label
    { font-size: 10px; font-weight: bold; white-space: nowrap; }
  .org-info-js_search-highlight
    { background-color: #ffff00; color: #000000; font-weight: bold; }
  .org-svg { }
</style>
<link rel="stylesheet" type="text/css" href="/assets/css/style.css"/><script src="/assets/js/theme.js"></script><script src="/assets/js/dynamic_var.js"></script><script src="/assets/js/site-nav.js"></script><link rel="preconnect" href="https://fonts.googleapis.com"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200&family=Roboto+Mono:wght@400;700&family=Inter:wght@400;500&display=swap" rel="stylesheet"><meta name="referrer" content="no-referrer">
<script>
  window.MathJax = {
    tex: {
      ams: {
        multlineWidth: '85%'
      },
      tags: 'ams',
      tagSide: 'right',
      tagIndent: '.8em'
    },
    chtml: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    svg: {
      scale: 1.0,
      displayAlign: 'center',
      displayIndent: '0em'
    },
    output: {
      font: 'mathjax-modern',
      displayOverflow: 'overflow'
    }
  };
</script>

<script
  id="MathJax-script"
  async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
</head>
<body>
<div id="preamble" class="status">
<div class="yorha-status">  <span class="status-indicator online"></span>  <span class="yorha-terminal">STATUS: OPERATIONAL</span></div><header class="main-header">  <div class="header-content">    <div class="logo">LOG: CALEB_CHRISTENSEN</div>    <nav class="main-nav">      <ul>        <li><a href="/">// HOME</a></li>        <li><a href="/sitemap.html">// SITEMAP</a></li>        <li><a href="/contact.html">// CONTACT</a></li>      </ul>    </nav>    <button class="theme-toggle" id="theme-toggle" title="Toggle theme">      <span class="material-symbols-outlined icon-sun">light_mode</span>      <span class="material-symbols-outlined icon-moon">dark_mode</span>    </button>  </div></header><div class="pattern"><div class="pattern-inner"></div></div>
</div>
<div id="content" class="content">
<h1 class="title">Building and Securing a Host OS</h1>
<div id="table-of-contents" role="doc-toc">
<h2>Table of Contents</h2>
<div id="text-table-of-contents" role="doc-toc">
<ul>
<li><a href="#org8d78a65">1. Introduction</a></li>
<li><a href="#orgabf5b42">2. Media Preparation</a>
<ul>
<li><a href="#org0a03bd0">2.1. Audit the Downloaded Image</a>
<ul>
<li><a href="#orgcaf55f2">2.1.1. Verify the Integrity</a></li>
<li><a href="#org8dd4b6a">2.1.2. (Optional) Export a JSON manifest for documentation and verification auditing.</a></li>
<li><a href="#org14c4bd7">2.1.3. (Optional, recommended) Verify the Authenticity</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#org9da7ae8">3. Create the Bootable USB Drive</a>
<ul>
<li><a href="#orgcfc80e2">3.1. Installing WSL2 Debian</a></li>
<li><a href="#org70d5fcd">3.2. Preparing WSL2 to Access Your USB Drive</a></li>
</ul>
</li>
<li><a href="#orge6ce719">4. OS Installation</a></li>
<li><a href="#org7e8a043">5. Server Configuration</a></li>
</ul>
</div>
</div>
<div id="outline-container-org8d78a65" class="outline-2">
<h2 id="org8d78a65"><span class="section-number-2">1.</span> Introduction</h2>
<div class="outline-text-2" id="text-1">
<p>
Before we confront the sealed firmware, we must first establish a foothold with a trusted environment we fully control. That begins with a bootable USB drive loaded with a stable, security-oriented, and —crucially— community-driven distribution: Debian. 
</p>

<p>
This distribution choice is a deliberate declaration. You are choosing the software that runs on your hardware. You are replacing opaque vendor code with something inspectable, modifiable, and community-audited. This is the first brick in your fortress of sovereignty.
</p>

<p>
Whether you create boot drive on your current laptop, a borrowed machine, or even a library computer — this USB is your single-factor, physical root-of-trust transfer token.
</p>

<p>
To install Debian on the target laptop, we need to create a bootable USB drive from an installer image file (.iso). We will use the Debian "net-installer," a minimal image that downloads the necessary packages during installation.
</p>

<p>
This Operating System will be our sovereign host, <code>Dom0</code>. In virtualization, <code>Dom0</code> (“Domain 0”) is the privileged control domain — the first and most trusted operating system started by the hypervisor. It has direct access to hardware and is responsible for managing all other virtual machines, these are called <code>DomU</code> (“Unprivileged Domain”).
</p>

<p>
In our architecture, the Debian system we’re about to install will become <code>Dom0</code> — the sovereign host that controls, monitors, and isolates everything else. It is the new “root of trust” — not because the firmware beneath it is trustworthy, but because it is auditable, modifiable, and under our control.
</p>

<p>
The <code>Dom0</code> is the seat of governance in our reclaimed machine. All other software from browsers, email clients, and even entire alternate operating systems, will run as guests, contained and observed.
</p>

<p>
We begin by installing Debian not as an “OS replacement,” but as the first layer of the sovereignty stack — built on freedom where you, not the vendor, exercise control and ownership.
</p>
</div>
</div>
<div id="outline-container-orgabf5b42" class="outline-2">
<h2 id="orgabf5b42"><span class="section-number-2">2.</span> Media Preparation</h2>
<div class="outline-text-2" id="text-2">
<p>
First, I need to collect the download link of not just the software installer image, but also proof of its integrity and proof of the proof’s authenticity.
</p>

<p>
At time of writing, the most transparent method of locating is to;
</p>
<ol class="org-ol">
<li>Use an internet browser and navigate to the official website, <a href="https://debian.org">https://debian.org</a>.</li>
<li>Follow the <a href="https://www.debian.org/distrib">Other downloads</a>{:target=_"blank"} link.</li>
<li><p>
Here, you can select the first link, <a href="https://www.debian.org/CD/http-ftp/#mirrors">Download mirrors{:target=_"blank"}</a> or the <a href="https://www.debian.org/CD/">complete installation image</a>{:target=_"blank"} lower down the page.
</p>

<p>
A. From the "complete installation image" redirect, choose the first link, <a href="https://www.debian.org/CD/http-ftp/">Download USB/CD/DVD images using HTTPS</a>
</p>
<ul class="org-ul">
<li>If using an Intel or AMD Processor, select <a href="https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/">amd64</a> for standard 64-bit computers under the <b>CD/USB</b> header.</li>
</ul>

<p>
B. From the "Download mirrors" redirect, scroll up to select  <a href="https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/">amd64</a> under the <b>CD/USB</b> header.
</p></li>

<li>Finally, we have reached the repository, review the <code>SHA512SUMS</code>, <code>SHA512SUMS.sign</code> and <code>debian-XX.X.X-amd64-netinst.iso</code> URLS, compare the URLS with the provided command:</li>
</ol>

<p>
Automated command set (Regex pattern works at time of publishing): 
</p>
<div class="org-src-container">
<pre class="src src-PowerShell"># Evergreen Debian download (always gets current stable)
Set-Location $Home\Desktop\debian-netinst
$IsoName = (Invoke-WebRequest -Uri "https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/" -UseBasicParsing).Content | Select-String -Pattern 'debian-[0-9.]*-amd64-netinst\.iso' | Select-Object -First 1 | ForEach-Object { $_.Matches[0].Value }
Invoke-WebRequest -Uri "https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/$IsoName" -OutFile $IsoName
Invoke-WebRequest -Uri "https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/SHA512SUMS" -OutFile "SHA512SUMS"
# You may need to press Enter again for the signature file
Invoke-WebRequest -Uri "https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/SHA512SUMS.sign" -OutFile "SHA512SUMS.sign"
</pre>
</div>

<p>
<i>Want to roll your own? <code>Right-click</code> &gt; <code>"Copy link address"</code> and paste fresh URLs below and build the command live.
  <b>Always</b> eyeball the result before you paste into a terminal.</i>
</p>

<p><b>Dynamic command set (updates live as you type):</b></p>

<div class="org-src-container">
<pre class="src src-powershell"># Download Debian installer and verification files  
Invoke-WebRequest -Uri "__ISOURL__" -OutFile (Split-Path "__ISOURL__" -Leaf)
Invoke-WebRequest -Uri "__CHECKSUMURL__" -OutFile (Split-Path "__CHECKSUMURL__" -Leaf)
Invoke-WebRequest -Uri "__SIGURL__" -OutFile (Split-Path "__SIGURL__" -Leaf)
</pre>
</div>

<p>
  <label for="isoURL"><b>Debian ISO URL:</b></label><br>
  <input type="text" id="isoURL" class="dynamic-input" data-placeholder="__ISOURL__" size="60" placeholder="Insert text to replace __ISOURL__">
</p>
<p>
  <label for="checksumURL"><b>SHA512SUMS URL:</b></label><br>
  <input type="text" id="checksumURL" class="dynamic-input" data-placeholder="__CHECKSUMURL__" size="60" placeholder="Insert text to replace __CHECKSUMURL__">
</p>
<p>
  <label for="checksumsigURL"><b>SHA512SUMS.sign URL:</b></label><br>
  <input type="text" id="checksumsigURL" class="dynamic-input" data-placeholder="__SIGURL__" size="60" placeholder="Insert text to replace __SIGURL__">
</p>

<div class="warning" id="orgf5caaec">
<p>
<strong>Security note:</strong> These inputs are evaluated in your browser only.
A malicious browser extension could alter them. Verify the command visually before execution.
</p>

</div>
</div>
<div id="outline-container-org0a03bd0" class="outline-3">
<h3 id="org0a03bd0"><span class="section-number-3">2.1.</span> Audit the Downloaded Image</h3>
<div class="outline-text-3" id="text-2-1">
<p>
Before writing anything to USB, it's important to verify the image is genuinely from Debian and has not been tampered with or corrupted.
</p>

<p>
This is layered verification: the ISO is checked against the checksum, and the checksum is checked against the signature. No single file is trusted in isolation. This is how sovereignty is built — brick by brick, hash by hash. 
</p>
<dl class="org-dl">
<dt>Checksum</dt><dd>Cryptographically calculated hash from a block of data, such as a file, that acts like a digital fingerprint. If even a single bit of data is different, the checksum will not match.</dd>
</dl>
</div>
<div id="outline-container-orgcaf55f2" class="outline-4">
<h4 id="orgcaf55f2"><span class="section-number-4">2.1.1.</span> Verify the Integrity</h4>
<div class="outline-text-4" id="text-2-1-1">
<p>
For minimal dependencies, we can use built-in the PowerShell CMDlet, <code>Get-FileHash</code>. However, this only verifies the hash matches what was downloaded, it does not ensure the orginal download is not malicious.
</p>
<ol class="org-ol">
<li><p>
Navigate to where the image was downloaded:
</p>
<div class="org-src-container">
<pre class="src src-powershell">cd $Home\Downloads
</pre>
</div></li>

<li><p>
Locate the specific downloaded ISO file:
</p>
<div class="org-src-container">
<pre class="src src-powershell">$IsoFile = Get-Item $Home\Downloads\debian-*-amd64-netinst.iso | Select-Object -ExpandProperty Name
</pre>
</div></li>

<li><p>
Next, extract the <b>expected</b> hash for your specific ISO from the SHA512SUMS file:
</p>
<div class="org-src-container">
<pre class="src src-powershell">$Expected = (Get-Content SHA512SUMS | Where-Object { $_ -match $IsoFile }) -split '\s+' | Select-Object -First 1
</pre>
</div></li>

<li><p>
Calculate the <b>actual</b> hash of your downloaded file:
</p>
<div class="org-src-container">
<pre class="src src-powershell">$Observed = (Get-FileHash -Algorithm SHA512 $IsoFile).Hash
</pre>
</div></li>

<li><p>
Finally, compare the hashes:
</p>
<div class="org-src-container">
<pre class="src src-powershell">if ($Expected.ToUpper() -eq $Observed.ToUpper()) {
    Write-Host "✅ SHA-512 MATCH" -ForegroundColor Green
    Write-Host "ISO SHA-512: $Observed" -ForegroundColor Cyan
} else {
    Write-Host "❌ SHA-512 MISMATCH" -ForegroundColor Red
    exit 1
}
</pre>
</div></li>
</ol>

<p>
If they do not match; delete the file and re-download.
</p>
</div>
</div>
<div id="outline-container-org8dd4b6a" class="outline-4">
<h4 id="org8dd4b6a"><span class="section-number-4">2.1.2.</span> (Optional) Export a JSON manifest for documentation and verification auditing.</h4>
<div class="outline-text-4" id="text-2-1-2">
<p>
This must be run in the same PowerShell Session as steps 1-4, if you are returning in a new terminal, return to those steps.
</p>
<ol class="org-ol">
<li><p>
Build an audit trail for documentation:
</p>
<div class="org-src-container">
<pre class="src src-powershell">@{
    IsoFile      = $IsoFile
    IsoSha512    = $Observed
    ChecksumFile = "SHA512SUMS"
    SigFile      = "SHA512SUMS.sign"
    Timestamp    = (Get-Date -Format "yyyy-MM-ddTHH:mm:ssK")
} | ConvertTo-Json |
    Out-File -Encoding utf8 "$Home\Downloads\debian-integrity.json"

Write-Host "Manifest saved to $Home\Downloads\debian-integrity.json" -ForegroundColor Cyan
</pre>
</div></li>
</ol>

<p>
This is the debian-integrity.json output I generated at time of publishing:
</p>
<pre class="example" id="orgb27742e">
{
    "IsoSha512":  "873E9AA09A913660B4780E29C02419F8FB91012C8092E49DCFE90EA802E60C82DCD6D7D2BEEB92EBCA0570C49244EEE57A37170F178A27FE1F64A334EE357332",
    "IsoFile":  "debian-13.1.0-amd64-netinst.iso",
    "Timestamp":  "2025-09-13T10:23:33-06:00",
    "ChecksumFile":  "SHA512SUMS",
    "SigFile":  "SHA512SUMS.sign"
}
</pre>
</div>
</div>
<div id="outline-container-org14c4bd7" class="outline-4">
<h4 id="org14c4bd7"><span class="section-number-4">2.1.3.</span> (Optional, recommended) Verify the Authenticity</h4>
<div class="outline-text-4" id="text-2-1-3">
<p>
I began by using <b>Gnu Privacy Guard</b> (GPG) to verify the Developer of our tools, establishing a critical first act of trust. Later, we’ll transform GPG into our personal keychain, managing our digital identity across the entire stack.
</p>
<dl class="org-dl">
<dt>Gnu Privacy Guard</dt><dd>A free and open-source implementation of the OpenPGP standard, which is based on the original PGP (Pretty Good Privacy) software. A foundational tool that enables the use of digital signatures and public-key cryptography to ensure the integrity and authenticity of files</dd>
</dl>
</div>
<ol class="org-ol">
<li><a id="orgc84ae7e"></a>Install GPG using Windows Package Manager, <code>winget</code>:<br />
<div class="outline-text-6" id="text-2-1-3-0-1">
<p>
First, we want to ensure we are protecting ourselves against <b>Typo Squatting</b>, where a bad actor will use a common mis-spelling of a package to distribute malware.
</p>
<dl class="org-dl">
<dt>Package Manager</dt><dd>Handles repository management and automatically resolves package dependencies. Think of it as an app store for your terminal; it handles finding, installing, and updating software.</dd>
</dl>

<p>
We will search for the software by name;
</p>
<div class="org-src-container">
<pre class="src src-powershell">winget search "Gnu Privacy Guard"
</pre>
</div>
<p>
It should return something similar to:
</p>
<pre class="example">
Name              Id          Version Source
---------------------------------------------
GNU Privacy Guard GnuPG.GnuPG 2.4.8   winget
</pre>


<p>
Any results cannot be blindly trusted and must be independently verified, we will <code>show</code> to get a detailed report of the search results.
</p>
<div class="org-src-container">
<pre class="src src-powershell">winget show GnuPG.GnuPG
</pre>
</div>
<p>
This search will yield multiple results. Before installing <i>anything</i>, <strong>it is critical to vet the package to avoid security risks like <b>typo squatting</b></strong>, where malicious actors upload packages with names similar to legitimate ones. We can inspect the full details of a package using <code>winget show</code> to find the <code>Id</code>, <code>Publisher</code>, and <code>Homepage</code> fields.
</p>

<p>
For each of the fields, these are <b>unverified claims</b> until independantly vetting using the following process:
</p>

<ol class="org-ol">
<li><b>Corroborate</b>: Do not blindly trust and navigate to the Homepage URL listed in the manifest. Instead, use an independent search engine to find the software's official project website. This is the non-negotiable step to establish a ground truth.</li>
<li><b>Verify</b>: Compare the Publisher name and package Id from the manifest against the official developer or organization name found on the official website. Any discrepancy, however minor, is a red flag that should halt the installation.</li>
<li><b>Execute</b>: Only after you have independently verified that the manifest's claims align with the official source, proceed with the installation using the precise command: <code>winget install --id &lt;PackageId&gt; --exact</code>.</li>
</ol>

<p>
Once verified, we can safely install;
</p>
<div class="org-src-container">
<pre class="src src-powershell">winget install GnuPG.GnuPG
</pre>
</div>
<p>
This time, since we used a package manager, we will not need to verify the integrity of the download using the hashes, as this is done automatically for us, and you have already authenticated the package in the previous step.
</p>

<p>
After installing a package, <code>winget</code> hands control over to that package installer. The installer itself is responsible for everything from where the program is placed on your hard drive to whether it adds shortcuts, registers file associations, and modifies the system's PATH environment variable. Some installers, especially for developer tools like GnuPG, assume you will handle this part yourself, as it can be a source of problems if not done correctly.
</p>

<p>
To do this, we will need to exit our existing PowerShell Session  (type <code>exit</code>, then "Enter\"), then open an additional PowerShell Terminal as an Administrator using: <kbd>Win+x</kbd> <kbd>a</kbd>. This ensures we have the permissions needed to modify the system PATH.
</p>

<p>
First, verify if the package was added to PATH:
</p>
<div class="org-src-container">
<pre class="src src-powershell">Get-Command gpg
</pre>
</div>
<p>
If you get an error that <code>gpg</code> is not found this does not mean the installation failed, but rather that we haven't told the system where to find it.
</p>

<p>
If it isn't found, paste in this script,
</p>
<div class="org-src-container">
<pre class="src src-powershell">$GpgExe = Get-ChildItem -Path "C:\Program Files*" -Filter "gpg.exe" -Recurse -ErrorAction SilentlyContinue | Select-Object -First 1
if ($GpgExe) {
    $GpgDir = Split-Path -Parent $GpgExe.FullName
    [Environment]::SetEnvironmentVariable("PATH", $Env:PATH + ";" + $GpgDir, [EnvironmentVariableTarget]::Machine)
    Write-Host "GPG added to PATH: $GpgDir" -ForegroundColor Green
} else {
    Write-Host "GPG installation not found" -ForegroundColor Red
    exit 1
}
</pre>
</div>
<p>
Or;
<i>Want to roll your own? Use these instructions.
     <b>Always</b> eyeball the result before you paste into a terminal.</i>
We need to locate where the installer downloaded the application to:
</p>
<div class="org-src-container">
<pre class="src src-powershell">Get-ChildItem -Path "C:\Program Files*" -Filter "gpg.exe" -Recurse -ErrorAction SilentlyContinue
</pre>
</div>
<p>
The <code>-ErrorAction SilentlyContinue</code> part just tells PowerShell not to show you any "Access Denied" errors it might encounter when trying to look inside protected system folders.
The result should list a Directory location, such as:
</p>
<pre class="example">
    Directory: C:\Program Files (x86)\gnupg\bin

Mode                 LastWriteTime         Length Name
----                 -------------         ------ ----
-a---          9/13/2025  10:23 AM         123456 gpg.exe
</pre>


<p>
Copy the Directory path (in this case: `C:\Program Files (x86)\gnupg\bin`) for the next step, adding the Directory path to the system PATH:
</p>
<div class="org-src-container">
<pre class="src src-powershell">[System.Environment]::SetEnvironmentVariable(
    "PATH", $env:PATH + ";" + "__GPGPATH__", [EnvironmentVariableTarget]::Machine)
</pre>
</div>
<p>
  <label for="gpgPath"><b>GPG Path:</b></label><br>
  <input type="text" id="gpgPath" name="gpgPath" class="dynamic-input" data-placeholder="__GPGPATH__" size="60" placeholder="Insert text to replace __GPGPATH__">
</p>

<p>
Refresh the environment variables for the PATH modification to take effect:
</p>
<div class="org-src-container">
<pre class="src src-powershell">refreshenv
</pre>
</div>

<p>
Now, we can confirm the installation:
</p>
<div class="org-src-container">
<pre class="src src-powershell">gpg --version
</pre>
</div>
</div>
</li>
<li><a id="orgf485c69"></a>Verification Using GPG<br />
<div class="outline-text-6" id="text-2-1-3-0-2">
<p>
Then, import Debian’s official signing keys. The provider key IDs we're importing are Debian’s official signing keys but you should never trust them just because a tutorial says so.
</p>

<p>
→ <a href="https://www.debian.org/CD/verify">Verify them yourself on Debian’s official site</a>.
</p>

<p>
We’ll use the 3 CD release signing keys listed:
</p>
<div class="org-src-container">
<pre class="src src-powershell">gpg --keyserver keyserver.ubuntu.com --recv-keys 988021A964E6EA7D DA87E80D6294BE9B 42468F4009EA8AC3
</pre>
</div>
<pre class="example" id="org439b59a">
gpg: C:\\Users\\caleb\\AppData\\Roaming\\gnupg\\trustdb.gpg: trustdb created
gpg: key 42468F4009EA8AC3: public key "Debian Testing CDs Automatic Signing Key &lt;debian-cd@lists.debian.org&gt;" imported
gpg: key DA87E80D6294BE9B: public key "Debian CD signing key &lt;debian-cd@lists.debian.org&gt;" imported
gpg: key 988021A964E6EA7D: public key "Debian CD signing key &lt;debian-cd@lists.debian.org&gt;" imported
gpg: Total number processed: 3
gpg:               imported: 3
</pre>

<p>
After importing the keys, verify the signature:
</p>
<div class="org-src-container">
<pre class="src src-powershell">gpg --verify SHA512SUMS.sign SHA512SUMS
</pre>
</div>
<p>
The output will likely look like this:
</p>
<pre class="example" id="org7475425">
gpg: Signature made 09/06/25 15:54:29 Mountain Daylight Time
gpg:                using RSA key DF9B9C49EAA9298432589D76DA87E80D6294BE9B
gpg: Good signature from "Debian CD signing key &lt;debian-cd@lists.debian.org&gt;" [unknown]
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: DF9B 9C49 EAA9 2984 3258  9D76 DA87 E80D 6294 BE9B
</pre>
<p>
This is <b><b>not an error</b></b> — it’s GPG doing its job.
This warning exists to protect you from “key substitution” attacks — where an attacker replaces a legitimate key on the keyserver with their own. By forcing you to verify the fingerprint against an official source (like debian.org over HTTPS), GPG ensures you’re not trusting a malicious imposter — even if their signature is mathematically valid.
</p>

<p>
Finally, check the key fingerprints:
</p>
<div class="org-src-container">
<pre class="src src-powershell">gpg --fingerprint 988021A964E6EA7D DA87E80D6294BE9B 42468F4009EA8AC3
</pre>
</div>

<p>
You should see output like:
</p>
<pre class="example" id="orgcaa45a3">
pub   rsa4096 2009-10-03 [SC]
      1046 0DAD 7616 5AD8 1FBC  0CE9 9880 21A9 64E6 EA7D
uid           [ unknown] Debian CD signing key &lt;debian-cd@lists.debian.org&gt;

pub   rsa4096 2011-01-05 [SC]
      DF9B 9C49 EAA9 2984 3258  9D76 DA87 E80D 6294 BE9B
uid           [ unknown] Debian CD signing key &lt;debian-cd@lists.debian.org&gt;
sub   rsa4096 2011-01-05 [E]

pub   rsa4096 2014-04-15 [SC]
      F41D 3034 2F35 4669 5F65  C669 4246 8F40 09EA 8AC3
uid           [ unknown] Debian Testing CDs Automatic Signing Key &lt;debian-cd@lists.debian.org&gt;
sub   rsa4096 2014-04-15 [E]
</pre>
<div class="note" id="org1bbf234">
<p>
The [unknown] indicates the trust level of your <b>local</b> trust database. You can reference the <a href="gpg.html">Cryptography with GNU Privacy Guard</a> to update this information.
</p>

</div>

<p>
Cross-reference the fingerprints on:
</p>
<ul class="org-ul">
<li><a href="https://www.debian.org/CD/verify">Debian CD Verification Guide</a></li>
<li><a href="https://ftp-master.debian.org/keys.html">Debian FTP Master Keys</a></li>
</ul>

<p>
If you find a match then you’ve successfully cryptographically and visually confirmed the key’s authenticity. This is the gold standard of verification.
</p>
</div>
</li>
</ol>
</div>
</div>
</div>
<div id="outline-container-org9da7ae8" class="outline-2">
<h2 id="org9da7ae8"><span class="section-number-2">3.</span> Create the Bootable USB Drive</h2>
<div class="outline-text-2" id="text-3">
</div>
<div id="outline-container-orgcfc80e2" class="outline-3">
<h3 id="orgcfc80e2"><span class="section-number-3">3.1.</span> Installing WSL2 Debian</h3>
<div class="outline-text-3" id="text-3-1">
<p>
This guide uses a primary workstation to remotely manage a secondary laptop that will host the 'Sovereignty Stack'. This provides a fundamental layer of isolation, preventing a compromise of the experimental system from immediately impacting the primary workstation.
</p>

<p>
From the primary workstation we will initialize and configure all of the tools needed for the project. As an accessible entry point, we will be using Windows 11. From the Desktop, use the following key-chord to open a PowerShell terminal as an Administrator:
<kbd>Win + x</kbd> <kbd>a</kbd>
</p>

<p>
Using Admin PowerShell terminal, run the following command to install the Windows Subsystem for Linux with the Debian distribution:
</p>
<div class="org-src-container">
<pre class="src src-powershell">wsl --install -d Debian
</pre>
</div>
<ul class="org-ul">
<li><b>Command Explanations</b>:
<dl class="org-dl">
<dt><code>wsl</code> - <i>(<u>W</u>indows <u>S</u>ubsystm for <u>L</u>inux)</i>:</dt><dd>A compatibility layer that allows Linux binary executables to interact with Kernel level processes without requiring disk-partitioning for a dual-boot set-up.
<dl class="org-dl">
<dt><code>--install</code>:</dt><dd>An option that initiates the WSL setup process and installs a Linux distribution.</dd>
<dt><code>-d</code> / <code>--distribution</code>:</dt><dd>A switch that flags the command we are specifying a non-default distribution. We are choosing Debian, but you can see other options with <code>wsl --list --online</code>.</dd>
</dl></dd>
</dl></li>
</ul>

<p>
We will next follow the on-screen instructions for standard Linux user creation.
</p>
<ul class="org-ul">
<li><p>
Create the default UNIX user account.
</p>
<pre class="example">
Enter new UNIX username:
</pre>

<p>
<kbd>Enter</kbd>
</p>
<pre class="example">
New password:
</pre>

<p>
<kbd>Enter</kbd>
</p>
<pre class="example">
Retype new password:
</pre>

<div class="note" id="orgba0eb5b">
<p>
As you enter the password, no visual feedback will be returned, not even a placeholder such as <code>****</code>, this is an intentional security design.
</p>

</div>

<p>
The terminal will print the following and drop you into the directory you were in when <code>wsl.exe</code> was executed for creating the UNIX User:
</p>
<pre class="example">
passwd: password updated successfully
usermod: no changes
$USERNAME@$HOSTNAME:/mnt/c/Users/%USERNAME%
</pre></li>
</ul>

<p>
Once you are at the Debian command-line interface, change your location from the Windows User directory to the UNIX User directory.
</p>
<div class="org-src-container">
<pre class="src src-nil">cd ~
</pre>
</div>
<ul class="org-ul">
<li><b>Command Explanations</b>:
<dl class="org-dl">
<dt><code>cd</code> - <i>(<u>C</u>hange <u>D</u>irectory)</i>:</dt><dd>Standard POSIX method for navigating the drive.</dd>
<dt><code>~</code> - <i>(Tilde)</i>:</dt><dd>Shorthand for <code>/home/$user</code>.</dd>
</dl></li>
</ul>
</div>
</div>
<div id="outline-container-org70d5fcd" class="outline-3">
<h3 id="org70d5fcd"><span class="section-number-3">3.2.</span> Preparing WSL2 to Access Your USB Drive</h3>
<div class="outline-text-3" id="text-3-2">
<p>
To use <code>dd</code>, we need WSL2 to see your USB drive as a raw block device (like <code>/dev/sdi</code>). By default, WSL2 only mounts Windows drives (C:, D:, etc.).
</p>

<p>
Plug in the USB, preferably using a rear I/O USB 2.0 port if available, as USB 3.0 devices sometimes have issues with passthrough
</p>

<p>
We’ll use <code>usbipd-win</code>, a Microsoft-supported open-source tool, to expose your USB to WSL2.
</p>
</div>
<ol class="org-ol">
<li><a id="orgbfc5722"></a>Step 1: Install usbipd-win<br />
<div class="outline-text-6" id="text-3-2-0-0-1">
<p>
From PowerShell (Admin):
</p>

<div class="org-src-container">
<pre class="src src-powershell">winget install usbipd
</pre>
</div>
<p>
Restart the session to add it to PATH. Review the earlier steps to add it manually if needed.
</p>
</div>
</li>
<li><a id="org0ab1052"></a>Step 2: List USB Devices<br />
<div class="outline-text-6" id="text-3-2-0-0-2">
<div class="org-src-container">
<pre class="src src-powershell">usbipd list
</pre>
</div>

<p>
You’ll see output like:
</p>
<pre class="example" id="org6a25c86">
Connected:
BUSID  VID:PID    DEVICE                                                        STATE
1-3    8087:0032  Intel(R) Wireless Bluetooth(R)                                Not shared
1-5    1bcf:2283  NexiGo N930AF FHD webcam, NexiGo N930AF FHD webcam Audio      Not shared
1-7    1532:0287  USB Input Device, Razer BlackWidow V4                         Not shared
1-10   0781:5581  USB Mass Storage Device                                       Not Shared
1-12   1b1c:0c0c  USB Input Device                                              Not shared
1-13   26ce:01a2  USB Input Device                                              Not shared
2-3    1532:0067  Razer Naga Trinity                                            Not shared
9-1    1997:2466  USB Input Device                                              Not shared
10-2   0bda:8153  Realtek USB GbE Family Controller #2                          Not shared

Persisted:
GUID                                  DEVICE
</pre>
<p>
The only storage device in this list is 
</p>
<pre class="example">
1-10    0781:5581  USB Mass Storage Device
</pre>

<p>
Which means this is what I am looking for.
</p>

<p>
If you have multiple USB Mass Storage devices, identify yours by:
</p>

<ol class="org-ol">
<li><b><b>Unplug the target USB drive</b></b> and run <code>usbipd list</code> - note which device disappears</li>
<li><b><b>Plug it back in</b></b> and run <code>usbipd list</code> again - the device that reappeared is your target</li>
<li><b><b>Check the VID:PID against known vendors</b></b>:
<ul class="org-ul">
<li>`0781` = SanDisk</li>
<li>`090c` = Silicon Motion (common in generic drives)</li>
<li>`8564` = Transcend</li>
<li>`13fe` = Kingston</li>
</ul></li>
</ol>
</div>
</li>
<li><a id="orgefe2d3f"></a>Step 3: Bind and Attach to WSL2<br />
<div class="outline-text-6" id="text-3-2-0-0-3">
<p>
From an Administrator PowerShell Session:
</p>
<div class="org-src-container">
<pre class="src src-powershell"># Replace 1-10 with your USB's BUSID
usbipd bind --busid 1-10
usbipd attach --wsl --busid 1-10
</pre>
</div>
<p>
You'll see some output such as:
</p>
<pre class="example" id="orgef38cd4">
usbipd: info: Using WSL distribution 'Debian' to attach; the device will be available in all WSL 2 distributions.
usbipd: info: Loading vhci_hcd module.
usbipd: info: Detected networking mode 'mirrored'.
usbipd: info: Using IP address 127.0.0.1 to reach the host.
</pre>

<p>
Run:
</p>
<div class="org-src-container">
<pre class="src src-powershell">usbipd list
</pre>
</div>
<p>
and the output should be updated to:
</p>
<pre class="example" id="orga31db50">
Connected:
BUSID  VID:PID    DEVICE                                                        STATE
1-3    8087:0032  Intel(R) Wireless Bluetooth(R)                                Not shared
1-5    1bcf:2283  NexiGo N930AF FHD webcam, NexiGo N930AF FHD webcam Audio      Not shared
1-7    1532:0287  USB Input Device, Razer BlackWidow V4                         Not shared
1-10   0781:5581  USB Mass Storage Device                                       Attached
1-12   1b1c:0c0c  USB Input Device                                              Not shared
1-13   26ce:01a2  USB Input Device                                              Not shared
2-3    1532:0067  Razer Naga Trinity                                            Not shared
6-1    10d6:b00d  HiDock_H1E                                                    Not shared
6-2    2ec2:0004  USB Serial Device (COM9), Loupedeck Live                      Not shared
9-1    1997:2466  USB Input Device                                              Not shared
9-4    1395:005c  HiDock H1E, USB Input Device                                  Not shared
10-2   0bda:8153  Realtek USB GbE Family Controller #2                          Not shared

Persisted:
GUID                                  DEVICE
</pre>
</div>
</li>
<li><a id="org1945b77"></a>Step 4: Verify in WSL2<br />
<div class="outline-text-6" id="text-3-2-0-0-4">
<p>
Open WSL2 Debian and run:
</p>
<div class="org-src-container">
<pre class="src src-powershell">wsl
</pre>
</div>

<div class="org-src-container">
<pre class="src src-bash">lsblk -d -o NAME,SIZE,MODEL,TRAN,RM | grep -E "usb|USB"
</pre>
</div>
<p>
You should see an output similar to:
</p>
<pre class="example" id="orgd600b37">
sdi    28.7G SanDisk 3.2Gen1 usb   1
</pre>
<p>
Always verify your target device shows:
</p>
<ul class="org-ul">
<li>Correct size (your USB capacity)</li>
<li>"usb" in TRAN column</li>
<li>"1" in RM (removable) column</li>
</ul>

<div class="tip" id="orgd6de8cb">
<p>
Double-check this is your USB as writing to the wrong device will erase it.
</p>

</div>

<p>
Now you’re ready to use <code>dd</code>.
</p>
</div>
</li>
</ol>
<li><a id="org0cc97be"></a>Write the Verified ISO to USB<br />
<div class="outline-text-5" id="text-3-2-0-1">
<p>
Now that we’ve cryptographically verified our ISO, we must write it to USB and then verify that the write was <b>bit-for-bit</b> perfect. A corrupted or miswritten USB will fail to boot, or worse, behave unpredictably during installation.
</p>
<div class="warning" id="orga06ce84">
<p>
NEVER run <code>dd</code> on these devices (they're your system):
<code>/dev/sda</code>, <code>=/dev/sdb</code>, <code>/dev/sdc</code>, etc.
(These are typically WSL2 virtual disks)
Only write to the device identified in Step 4, <code>/dev/sdi</code> in this case.
</p>

</div>

<p>
Set the paths for the variables;
The WSL username may differ from the Windows username. 
Verify the correct path with:
</p>
<div class="org-src-container">
<pre class="src src-nil">ls /mnt/c/Users/*/Downloads/debian*
</pre>
</div>
<p>
Then set the user using your actual Windows username.
<i>Assuming the user is "user"</i>
</p>
<div class="org-src-container">
<pre class="src src-nil">WIN_USER="user"
</pre>
</div>

<p>
<i>Assuming your USB is "/dev/sdi" and your ISO is in "/mnt/c/Users/user/Downloads</i>\"/ 
</p>
<div class="org-src-container">
<pre class="src src-bash">ISO="/mnt/c/Users/$WIN_USER/Downloads/debian-13.1.0-amd64-netinst.iso"
USB_DEVICE="/dev/sdi" # or /dev/ + the lsblk output
</pre>
</div>
<p>
Run the command:
</p>
<div class="org-src-container">
<pre class="src src-bash">sudo dd if="$ISO" of="$USB_DEVICE" bs=4M status=progress oflag=sync
sudo sync
</pre>
</div>
<p>
<b>Command Explanations</b>:
</p>
<dl class="org-dl">
<dt><code>dd</code></dt><dd>“data duplicator,” a low-level block copy tool.</dd>
<dt><code>if=...</code></dt><dd>input file (your verified ISO).</dd>
<dt><code>of=...</code></dt><dd>output file (your USB device).</dd>
<dt><code>bs=4M</code></dt><dd>block size for faster writes.</dd>
<dt><code>status=progress</code></dt><dd>show progress.</dd>
<dt><code>oflag=sync</code></dt><dd>ensure all data is written before completion.</dd>
</dl>

<p>
<i>Want to insert your own USB path? Use these instructions.
     <b>Always</b> eyeball the result before you paste into a terminal.</i>
</p>
<div class="org-src-container">
<pre class="src src-bash">sudo dd if="__ISOPATH__" of="__USBDEV__" bs=4M status=progress oflag=sync
sudo sync
</pre>
</div>
<p>
#+begin<sub>export</sub> html
&lt;input type="text" id="ISOPath" class="dynamic-input" data-placeholder="<span class="underline"><span class="underline">ISOPATH</span></span>" value="ISO Download path"&gt;
#+end<sub>export</sub> html
#+begin<sub>export</sub> html
&lt;input type="text" id="usbDevice" class="dynamic-input" data-placeholder="<span class="underline"><span class="underline">USBDEV</span></span>" size="10" value="/dev/sdi"&gt;
#+end<sub>export</sub> html
</p>

<p>
The output should be similiar to:
</p>
<div class="org-src-container">
<pre class="src src-nil">821035008 bytes (821 MB, 783 MiB) copied, 104 s, 7.9 MB/s
195+1 records in
195+1 records out
821035008 bytes (821 MB, 783 MiB) copied, 104.264 s, 7.9 MB/s
</pre>
</div>

<p>
Now we will verify the etching was completed successfully by performing a final checksum on the USB Drive.
</p>
<div class="org-src-container">
<pre class="src src-bash"># Get the original ISO hash from the JSON file
ISO_HASH_FROM_FILE=$(grep -o '"IsoSha512":\s*"[^"]*"' /mnt/c/Users/$WIN_USER/Downloads/debian-integrity.json | cut -d'"' -f4)

# Calculate USB hash
USB_HASH=$(sudo head -c "$BYTES" "$USB_DEVICE" | sha512sum | awk '{print $1}')

# Compare (case-insensitive since JSON might be uppercase)
if [ "${USB_HASH^^}" = "${ISO_HASH_FROM_FILE^^}" ]; then
    echo "✓ USB write verified successfully - hashes match"
    echo "Original: $ISO_HASH_FROM_FILE"
    echo "USB:      ${USB_HASH^^}"
else
    echo "✗ CRITICAL: Hash mismatch - USB is corrupted!"
    echo "Original: $ISO_HASH_FROM_FILE"
    echo "USB:      ${USB_HASH^^}"
fi
</pre>
</div>
<p>
Here's the output I received:
</p>
<div class="org-src-container">
<pre class="src src-nil">✓ USB write verified successfully - hashes match
Original: 873E9AA09A913660B4780E29C02419F8FB91012C8092E49DCFE90EA802E60C82DCD6D7D2BEEB92EBCA0570C49244EEE57A37170F178A27FE1F64A334EE357332
USB:      873E9AA09A913660B4780E29C02419F8FB91012C8092E49DCFE90EA802E60C82DCD6D7D2BEEB92EBCA0570C49244EEE57A37170F178A27FE1F64A334EE357332
</pre>
</div>
<p>
The two hashes <b><b>must match exactly</b></b>.
</p>

<p>
If they don’t:
</p>
<ul class="org-ul">
<li>Try re-writing the USB.</li>
<li>Try a different USB port or drive.</li>
<li>Never proceed with a mismatched hash — your USB is corrupted.</li>
</ul>

<p>
This is the final checkpoint before booting. Sovereignty means verifying <b>every</b> link in the chain — download → signature → write → boot.
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="outline-container-orge6ce719" class="outline-2">
<h2 id="orge6ce719"><span class="section-number-2">4.</span> OS Installation</h2>
<div class="outline-text-2" id="text-4">
<p>
Before we install, we need 2 last peices of information from the machine:
We'll need to know two things from your local network:
</p>

<ul class="org-ul">
<li>Your router's IP address (e.g., 192.168.1.1).</li>

<li>A free IP address on that network (e.g., 192.168.1.123).</li>
</ul>

<p>
From a Windows machine - Discover usable static-IP triple (IP/mask, gateway, next-free)
</p>
<div class="org-src-container">
<pre class="src src-powershell">$Route = Get-NetRoute -DestinationPrefix "0.0.0.0/0" -ErrorAction Stop
$GW    = $Route.NextHop
$Adapter = Get-NetAdapter -InterfaceIndex $Route.ifIndex -ErrorAction Stop
$IPconf  = Get-NetIPAddress -InterfaceIndex $Adapter.ifIndex -AddressFamily IPv4 -ErrorAction SilentlyContinue
if (-not $IPconf) { Write-Error "No IPv4 on adapter $($Adapter.Name)"; exit 1 }

# Build subnet base (192.168.1.0/24 → 192.168.1)
$Base  = $IPconf.IPAddress -replace '\.\d+$',''
$Mask  = $IPconf.PrefixLength

# Find first free host address (x.x.x.200 → x.x.x.250)
$Start = 200
$End   = 250
for ($i = $Start; $i -le $End; $i++) {
    $Candidate = "$Base.$i"
    if (-not (Test-Connection $Candidate -Count 1 -Quiet -TimeoutSeconds 100)) {
        Write-Host "Use these in the installer:"
        Write-Host "IP address : $Candidate/$Mask"
        Write-Host "Gateway    : $GW"
        break
    }
}
</pre>
</div>

<p>
Boot the laptop from the USB stick, attach the USB-Ethernet adapter, plug into the router and begin the installation.
</p>

<p>
Since the laptop has a built in Network adapter, the installer may ask to load non-free firmware for the built-in Wi-Fi.
</p>
<ul class="org-ul">
<li>(n) keeps the installation 100% open-source</li>
<li>(y) enables wireless networking.</li>
</ul>

<p>
Using a USB-to-Ethernet adapter, I was presented with the following error:
</p>
<pre class="example">
Network autoconfiguration failed

Your network is probably not using the DHCP protocol. Alternatively, the DHCP server may be slow or some network hardware is not working properly.
</pre>


<p>
Skip network autoconfiguration; we’ll set a static address from <code>Dom0</code> where we have better debugging tools.
</p>

<p>
On the partition screen, we will select
</p>
<pre class="example">
Guided - use entire disk and setup LVM with encryption.
</pre>


<p>
The best option for a stable Xen hypervisor is the classic server setup
</p>
<pre class="example">
Separate /home, /var, and /tmp partitions.
</pre>


<p>
This scheme provides the isolation needed to run a stable hypervisor. When the installer asks you how to allocate the space, Allocate ~70 % of available space to <code>/var</code>; exact GiB numbers aren’t critical because LVM lets you resize later, as this is where your VMs will live. A good starting point might be 20% for <code>/</code>, 8% for <code>/home</code>, 2% for <code>/tmp</code>, and the rest for <code>/var</code>.
</p>

<p>
This will seperate the core Debian operating system, protecting it from runaway processes. By default, the virtual disk images of your Xen VMs (<code>/var/lib/xen/images</code>). By giving <code>/var</code> its own large partition, you ensure that even if a VM's disk grows unexpectedly or a log file gets huge, it can only fill up the <code>/var</code> partition and will not crash the core OS.
</p>

<p>
Since we are using LVM, these sizes aren't set in stone and can be adjusted later, but this layout provides the right structure from the start.
</p>

<p>
For the package mangager, we will continue without a network mirror.
</p>

<p>
On the Software Selection screen: Deselect everything except SSH server and standard system utilities.
</p>

<p>
Finish the install. Before you reboot, capture the LUKS parameters shown below—needed for the sovereignty audit in <a href="04-crypto.html">P1</a>.
</p>

<p>
⚠️  Sovereignty checkpoint – copy once, audit later
On the partition summary screen, open a second virtual console:
Alt-F2 → Enter → run:
</p>

<div class="org-src-container">
<pre class="src src-nil">cryptsetup luksDump /dev/nvme0n1p2 | grep -E 'Cipher|PBKDF|Iterations|Key:|UUID'
</pre>
</div>

<p>
Example output (yours will differ slightly):
</p>
<pre class="example">
Cipher:      aes-xts-plain64
Key Size:    512 bits
PBKDF:       pbkdf2
Iterations:  506481
UUID:        12345678-1234-1234-1234-123456789abc
</pre>


<p>
Write those lines into the installer’s “Go Back” → “Save Debug Logs” prompt,
or snap a phone photo.
</p>
</div>
</div>
<div id="outline-container-org7e8a043" class="outline-2">
<h2 id="org7e8a043"><span class="section-number-2">5.</span> Server Configuration</h2>
<div class="outline-text-2" id="text-5">
<p>
Now that we are officially booted into the minimal host OS, there are a few configuration steps before moving on to the Virtualization.
First, you need to get your USB Ethernet adapter working and set up your package manager's sources.
</p>

<p>
All of these commands require administrator privileges.
</p>
<div class="org-src-container">
<pre class="src src-shell">su -
</pre>
</div>
<dl class="org-dl">
<dt><code>su</code></dt><dd>This stands for "substitute user." By default, it switches you to the root user if you don't specify another username.</dd>

<dt><code>-</code></dt><dd>This is a flag that tells su to start a login shell. This means it simulates a full login as the new user.</dd>
</dl>
</div>
<ol class="org-ol">
<li><a id="org2acbf82"></a>Initial Network Bridge Configuration<br />
<div class="outline-text-5" id="text-5-0-0-1">
<p>
For guest VMs (DomUs) to access the network, we must create a network bridge. The bridge acts like a virtual switch, sharing the physical network card with the VMs.
</p>

<p>
First, identify your primary physical network interface:
Find your network interface name.
</p>
<div class="org-src-container">
<pre class="src src-shell">ip a
</pre>
</div>
<p>
Look for an interface that isn't `lo`. It will have a name like `enp3s0` or `enx&#x2026;` for a USB adapter.
</p>

<pre class="example">
1: lo: &lt;LOOPBACK, UP, LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
...
...
...
2: enx00051bde17f2: &lt;BROADCAST, MULTICAST, DOWN, LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
...
...
...
3: wlp1se: &lt;BROADCAST, MULTICAST&gt; mtu 1500 qdisc noop state DOHN group default qlen 1000
...
...
...
</pre>


<p>
The USB Ethernet adapter (enx&#x2026;) is recognized by the system, but it's not active <code>state DOWN</code>. Because it's down, it never asked your router for an IP address, so you have no network connection and DNS lookups are failing.
</p>
<div class="org-src-container">
<pre class="src src-shell">ip link set enx00051bde17f2 up
</pre>
</div>

<div class="org-src-container">
<pre class="src src-shell">ip a
</pre>
</div>

<pre class="example">
1: 10: &lt;LOOPBACK, UP, LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000
link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
inet 127.0.0.1/8 scope host lo
valid_ift forever preferred_1ft forever
inet6 /128 scope host noprefixroute
valid_ift forever preferred_lft forever
2: enx00051bde17f2: &lt;BROADCAST, MULTICAST, UP, LOWER_UP&gt; mtu 1500 qdisc fq_codel state UP group default qlen 1000
link/ether 00:05:1b:de:17:12 brd ff:ff:ff:ff:ff:ff
inet6
/64 scope global dynamic mngtmpaddr proto kernel_ra
valid_lft 85456sec preferred_1ft 63856sec
inet6
/64 scope link proto kernel_11
valid_lft forever preferred_lft forever
3: wlp1se: &lt;BROADCAST, MULTICAST&gt; mtu 1500 qdisc noop state DOHN group default qlen 1000
link/ether 30:95:09:19:f9:cb brd ff:ff:ff:ff:ff:ff
altname wlx3c9509f9f9cb
</pre>


<p>
The <code>ip a</code> output shows the adapter and cable are working perfectly. The <code>inet6</code> addresses mean your laptop is already communicating with your router over IPv6. The problem is strictly with IPv4.
</p>

<p>
We'll manually assign one temporarily. This will get us online so we can install the proper tools.
</p>

<p>
Here are the steps to take as root:
</p>

<p>
Assign a static IP address. Replace 192.168.1.123/24 with a free IP address on your network.
</p>
<div class="org-src-container">
<pre class="src src-shell">ip addr add 192.168.1.123/24 dev enx00051bde17f2
</pre>
</div>
<div class="note" id="org0629bf4">
<p>
The /24 is the subnet mask and is standard for home networks.
</p>

</div>

<p>
Set the default gateway. This tells your laptop how to reach the internet. Replace 192.168.1.1 with your router's IP address.
</p>
<div class="org-src-container">
<pre class="src src-shell">ip route add default via 192.168.1.1
</pre>
</div>

<p>
Configure DNS. You need to tell the system where to look up domain names.
</p>
<div class="org-src-container">
<pre class="src src-shell">cat &gt; /etc/systemd/network/10-usb0.network &lt;&lt;EOF
[Match]
Name=enx*

[Network]
DHCP=no
Address=192.168.1.123/24     # &lt;-- replace with verified open IP address
Gateway=192.168.1.1
DNS=1.1.1.1
EOF
</pre>
</div>

<p>
Unplug and replug your USB Ethernet adapter. You should now have a network connection. You can test it by running <code>ping 1.1.1.1</code>.
You'll need to end the ping test with a keyboard interruption, <kbd>Ctrl+c</kbd>.
</p>

<p>
By default, Debian has a network interface (like <code>enx...</code>) that connects directly to the internet. For future guest VMs (DomUs) to access the network, we need to create a network bridge.
</p>

<p>
The bridge acts like a virtual network switch. Your physical network card will be attached to the bridge, and all your VMs will also connect their virtual network cards to this same bridge, allowing them to share the network connection seamlessly.
</p>

<p>
I had to edit my network configuration file, this is typically located at <code>/etc/network/interfaces</code>.
</p>
<div class="org-src-container">
<pre class="src src-conf"># Example /etc/network/interfaces for bridging

# The loopback network interface
auto lo
iface lo inet loopback

# The primary network interface
# This line makes the physical NIC part of the bridge
allow-hotplug enx00051bde17f2
iface enx00051bde17f2 inet manual

# The bridge setup
auto br0
iface br0 inet dhcp
bridge_ports enx00051bde17f2
bridge_stp off
bridge_fd 0
</pre>
</div>

<p>
Verify the bridge is working:
</p>
<div class="org-src-container">
<pre class="src src-nil">ip a show br0
</pre>
</div>
<p>
My output was:
</p>
<pre class="example" id="org1546685">
4: br0: &lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1500 qdisc noqueue state UP group default qlen 1000
    link/ether 06:8d:4f:d1:17:71 brd ff:ff:ff:ff:ff:ff
    inet 192.168.1.109/24 brd 192.168.1.255 scope global dynamic br0
       valid_lft 67363sec preferred_lft 67363sec
    inet6 2605:a601:8012:cd00:48d:4fff:fed1:1771/64 scope global dynamic mngtmpaddr proto kernel_ra
       valid_lft 86394sec preferred_lft 64794sec
    inet6 fe80::48d:4fff:fed1:1771/64 scope link proto kernel_ll
       valid_lft forever preferred_lft forever
</pre>

<p>
Configure the APT sources to ensure the package manager can find all necessary software.
</p>
<div class="org-src-container">
<pre class="src src-shell">nano /etc/apt/sources.list
</pre>
</div>

<div class="org-src-container">
<pre class="src src-conf">#deb cdrom: [Debian GNU/Linux 13.1.0_Trixie_ - Official amd64 NETINST with firmware 20250906-10:22]/ trixie contrib main non-free-firmware

# This system was installed using removable media other than
# CD/DVD/BD (e.g. USB stick, SD card, ISO image file).
# The matching "deb cdrom" entries were disabled at the end
# of the Installation process.
# For information about how to configure apt package sources.
# see the sources.list (5) manual.
deb http://deb.debian.org/debian/ trixie main non-free-firmware contrib
deb-src http://deb.debian.org/debian/ trixie main non-free-firmware contrib

deb http://security.debian.org/debian-security trixie-security main non-free-firmware contrib
deb-src http://security.debian.org/debian-security trixie-security main non-free-firmware contrib

deb http://deb.debian.org/debian/ trixie-updates main non-free-firmware contrib
deb-src http://deb.debian.org/debian/ trixie-updates main non-free-firmware contrib
</pre>
</div>

<div class="org-src-container">
<pre class="src src-shell">apt update
</pre>
</div>
<p>
Now, you can install the remote access server, OpenSSH.
</p>
<div class="org-src-container">
<pre class="src src-shell">apt install openssh-server
</pre>
</div>

<p>
Back at the workstation, install the Secure Shell software.
</p>
<div class="org-src-container">
<pre class="src src-nil">sudo apt install ssh
</pre>
</div>
<p>
Generate a key pair if you don't have one:
</p>
<div class="org-src-container">
<pre class="src src-nil">ssh-keygen -t ed25519 -C "your_email@example.com"
</pre>
</div>
<div class="note" id="orgfb8b559">
<p>
The email is for pure convenience, SSH ignores it cryptographically. when you later open authorized<sub>keys</sub> on some server you can see whose key that line is without matching long fingerprints.
</p>

</div>

<p>
Copy the public key to your Xen laptop:
</p>
<div class="org-src-container">
<pre class="src src-nil">ssh-copy-id user@laptop_ip
</pre>
</div>

<p>
Now, use the key-pair to access the laptop remotely:
</p>
<div class="org-src-container">
<pre class="src src-nil">ssh user@laptop_ip
</pre>
</div>

<p>
This setting only allows log in using an SSH key, which is secure. 
</p>
<div class="org-src-container">
<pre class="src src-nil">sudo mkdir -p /root/.ssh
</pre>
</div>
<p>
Set the permissions
</p>
<div class="org-src-container">
<pre class="src src-nil">chmod 700 /root/.ssh
</pre>
</div>

<p>
Now, we will also add the key to the root:
</p>
<div class="org-src-container">
<pre class="src src-bash">cat &gt;&gt; /etc/ssh/sshd_config &lt;&lt;EOF

# Sovereignty stack hardening
PermitRootLogin prohibit-password
PasswordAuthentication no
AuthenticationMethods publickey
EOF
systemctl restart ssh
</pre>
</div>

<p>
From your desktop, make sure you can SSH into the Xen host without a password. This is the ultimate test.
</p>
<div class="org-src-container">
<pre class="src src-nil">ssh user@192.168.1.109
</pre>
</div>

<p>
You can see how to headlessly reboot a server using LVM encryption with an SSH connection here: <a href="./dropbear-initramfs-config.html">Headless LUKS unlock using SSH</a>
</p>
</div>
</li>
</ol>
</div>
</div>
<div id="postamble" class="status">
<footer class="main-footer"><p>Last Modified: 2025-09-13</p><p>This site is built with Emacs and Org-mode.</p><p>// SYSTEM_NORMAL // [C] 2025 CALEB CHRISTENSEN</p></footer><script src="https://platform.linkedin.com/badges/js/profile.js" async defer type="text/javascript"></script>
</div>
</body>
</html>
